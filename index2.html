<!--
  index.html - Industrial Packing Line Operator UI
  Created by Copilot Wireframer
  
  This file is generated from core/wireframer.html as a base for further UI development.
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Packing Line Operator Dashboard</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>
<body class="bg-gray-950 text-gray-100 min-h-screen">
    <!-- Navigation Bar -->
    <nav class="bg-gradient-to-r from-blue-900 to-blue-800 text-white px-4 py-3 flex items-center justify-between shadow-lg border-b border-blue-700">
        <div class="flex items-center gap-4">
            <span class="font-bold text-2xl tracking-wide flex items-center gap-2">
                <svg class="w-7 h-7 text-blue-300" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="#2563eb" /><path d="M8 14s1.5-2 4-2 4 2 4 2" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/><circle cx="9" cy="10" r="1.5" fill="#fff"/><circle cx="15" cy="10" r="1.5" fill="#fff"/></svg>
                Packing Line Dashboard
            </span>
            <div class="hidden md:flex gap-4 ml-8">
                <a href="#state" class="hover:text-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-300 transition">Current State</a>
                <a href="#events" class="hover:text-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-300 transition">Past Events</a>
                <a href="#telemetry" class="hover:text-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-300 transition">Telemetry Replay</a>
                <a href="#alerts" class="hover:text-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-300 transition">Alerts</a>
                <a href="#ml" class="hover:text-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-300 transition">ML Models</a>
            </div>
        </div>
        <div class="flex items-center gap-3">
            <div class="flex items-center gap-2 bg-blue-800 rounded-lg px-3 py-1 border border-blue-700">
                <img src="https://ui-avatars.com/api/?name=Operator+Name&background=0D8ABC&color=fff" alt="User avatar" class="w-8 h-8 rounded-full border border-blue-400">
                <div class="hidden sm:flex flex-col text-right">
                    <span class="font-semibold text-white text-sm leading-tight">Operator Name</span>
                    <span class="text-xs text-blue-200 leading-tight">operator@plant.com</span>
                </div>
            </div>
            <button class="ml-2 text-blue-300 hover:text-white text-xs font-medium focus:outline-none focus:ring-2 focus:ring-blue-300 transition">Sign out</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="p-4 max-w-7xl mx-auto">
        <!-- 2D Schematic Section -->
        <section id="schematic" class="mb-8 mt-4 relative">
            <h2 class="text-xl font-semibold mb-2 text-blue-200">Packing Line Schematic
                <button tabindex="0" aria-label="Personas & Tasks" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-blue-300' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><circle cx='12' cy='12' r='10' stroke='currentColor' stroke-width='2'/><path d='M12 16v-4M12 8h.01' stroke='currentColor' stroke-width='2' stroke-linecap='round'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>Personas & Tasks</b><ul class='mt-1 ml-2 list-disc list-inside'><li><b>Software Engineering:</b> Build and maintain UI and backend</li><li><b>User Acceptance Testing:</b> Validate usability and correctness</li><li><b>Project Management:</b> Define requirements, track progress</li><li><b>Data Science:</b> Develop and validate ML models</li><li><b>Business SME:</b> Provide domain expertise</li></ul></div>
                    </span>
                </button>
                <button tabindex="0" aria-label="AI Impacts" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-green-400' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><rect x='4' y='4' width='16' height='16' rx='4' stroke='currentColor' stroke-width='2'/><path d='M8 12h8M12 8v8' stroke='currentColor' stroke-width='2' stroke-linecap='round'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>AI Impacts</b><ul class='mt-1 ml-2 list-disc list-inside'><li><span class='font-semibold text-green-400'>Positive:</span> Predictive maintenance reduces downtime <span class='text-blue-300'>(Personas: Operator, Data Science)</span></li><li><span class='font-semibold text-red-400'>Negative:</span> Over-reliance on AI may mask real issues <span class='text-blue-300'>(Personas: Operator, Project Management)</span></li></ul></div>
                    </span>
                </button>
                <button tabindex="0" aria-label="Design Intent" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-yellow-300' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><path d='M12 6v6l4 2' stroke='currentColor' stroke-width='2' stroke-linecap='round'/><circle cx='12' cy='12' r='10' stroke='currentColor' stroke-width='2'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>Design Intent</b><ul class='mt-1 ml-2 list-disc list-inside'><li><b>Functionality:</b> Show real-time and simulated state of each machine</li><li><b>Data:</b> Live and historical telemetry, state, and events</li><li><b>Behavior:</b> Interactive, updates with timeline, click to select machine</li></ul></div>
                    </span>
                </button>
            </h2>
            <div class="overflow-x-auto relative">
                <div id="schematic-legend" class="flex gap-6 mb-2 text-xs text-blue-200">
                    <div class="flex items-center gap-1"><span class="inline-block w-3 h-3 rounded-full bg-green-400"></span> Running</div>
                    <div class="flex items-center gap-1"><span class="inline-block w-3 h-3 rounded-full bg-yellow-400"></span> Idle</div>
                    <div class="flex items-center gap-1"><span class="inline-block w-3 h-3 rounded-full bg-red-500"></span> Fault</div>
                    <div class="flex items-center gap-1"><span class="inline-block w-3 h-3 rounded-full bg-blue-400"></span> Sensor</div>
                </div>
                <div class="relative">
                    <svg id="line-schematic" viewBox="0 0 900 220" class="w-full max-w-5xl h-60 bg-gradient-to-br from-blue-950 to-blue-800 rounded-xl shadow-lg p-4 border border-blue-900" aria-label="2D schematic of the packing line">
                        <!-- Schematic will be rendered by JS -->
                    </svg>
                    <!-- Info cards for each machine (floating, accessible, responsible AI) -->
                    <div id="machine-info-cards" class="pointer-events-none absolute top-0 left-0 w-full h-full z-10"></div>
                </div>
            </div>
        </section>
        <!-- Telemetry Graph Section -->
        <section id="telemetry-graph" class="mb-8">
            <h2 class="text-xl font-semibold mb-2 text-blue-200">Telemetry Graph: <span id="telemetry-machine-label">Filler</span>
                <button tabindex="0" aria-label="Personas & Tasks" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-blue-300' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><circle cx='12' cy='12' r='10' stroke='currentColor' stroke-width='2'/><path d='M12 16v-4M12 8h.01' stroke='currentColor' stroke-width='2' stroke-linecap='round'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>Personas & Tasks</b><ul class='mt-1 ml-2 list-disc list-inside'><li><b>Software Engineering:</b> Build and maintain UI and backend</li><li><b>User Acceptance Testing:</b> Validate usability and correctness</li><li><b>Project Management:</b> Define requirements, track progress</li><li><b>Data Science:</b> Develop and validate ML models</li><li><b>Business SME:</b> Provide domain expertise</li></ul></div>
                    </span>
                </button>
                <button tabindex="0" aria-label="AI Impacts" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-green-400' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><rect x='4' y='4' width='16' height='16' rx='4' stroke='currentColor' stroke-width='2'/><path d='M8 12h8M12 8v8' stroke='currentColor' stroke-width='2' stroke-linecap='round'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>AI Impacts</b><ul class='mt-1 ml-2 list-disc list-inside'><li><span class='font-semibold text-green-400'>Positive:</span> Predictive maintenance reduces downtime <span class='text-blue-300'>(Personas: Operator, Data Science)</span></li><li><span class='font-semibold text-red-400'>Negative:</span> Over-reliance on AI may mask real issues <span class='text-blue-300'>(Personas: Operator, Project Management)</span></li></ul></div>
                    </span>
                </button>
                <button tabindex="0" aria-label="Design Intent" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-yellow-300' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><path d='M12 6v6l4 2' stroke='currentColor' stroke-width='2' stroke-linecap='round'/><circle cx='12' cy='12' r='10' stroke='currentColor' stroke-width='2'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>Design Intent</b><ul class='mt-1 ml-2 list-disc list-inside'><li><b>Functionality:</b> Visualize sensor data over time</li><li><b>Data:</b> Telemetry arrays for each machine</li><li><b>Behavior:</b> Updates with timeline, highlights selected machine</li></ul></div>
                    </span>
                </button>
            </h2>
            <div class="bg-gray-900 rounded-lg shadow p-4 flex flex-col gap-4 border border-blue-900">
                <canvas id="telemetry-canvas" class="w-full h-40 bg-blue-950 rounded"></canvas>
            </div>
        </section>
        <!-- Timeline Controls -->
        <section id="timeline-controls" class="mb-8">
            <h2 class="text-xl font-semibold mb-2 text-blue-200">Timeline Mode</h2>
            <div class="flex flex-col md:flex-row md:items-center gap-4 bg-gray-900 rounded-lg p-4 border border-blue-900">
                <div class="flex gap-4 items-center">
                    <label class="flex items-center gap-2 cursor-pointer">
                        <input type="radio" name="timeline-mode" value="realtime" checked class="accent-blue-700">
                        <span>Realtime</span>
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer">
                        <input type="radio" name="timeline-mode" value="simulation" class="accent-blue-700">
                        <span>Simulation</span>
                    </label>
                </div>
                <div class="flex-1 flex items-center gap-4">
                    <label for="telemetry-range" class="text-sm font-medium text-blue-200">Timeline:</label>
                    <input id="telemetry-range" type="range" min="0" max="100" value="50" class="w-full accent-blue-700">
                    <button id="replay-btn" class="bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 transition">Replay</button>
                </div>
            </div>
            <div class="flex justify-between text-xs text-blue-200 mt-1">
                <span id="timeline-left-label">Past</span>
                <span id="timeline-center-label">Now</span>
                <span id="timeline-right-label">Forecast</span>
            </div>
        </section>
        <!-- Current State Section -->
        <section id="state" class="mb-8">
            <h2 class="text-xl font-semibold mb-2 text-blue-200">Current Packing Line State</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <!-- Example Machine Card -->
                <div class="bg-gray-900 rounded-lg shadow p-4 flex flex-col gap-2 border border-blue-900">
                    <div class="flex items-center gap-2">
                        <span class="inline-block w-3 h-3 rounded-full bg-green-400" aria-label="Running"></span>
                        <span class="font-medium text-gray-100">Filler #1</span>
                    </div>
                    <div class="text-sm text-gray-400">Status: Running</div>
                    <div class="text-xs text-gray-600">Last updated: 2 min ago</div>
                </div>
                <!-- Add more machine cards as needed -->
            </div>
        </section>

        <!-- Past Events Section -->
        <section id="events" class="mb-8">
            <h2 class="text-xl font-semibold mb-2 text-blue-200">Past Events
                <button tabindex="0" aria-label="Personas & Tasks" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-blue-300' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><circle cx='12' cy='12' r='10' stroke='currentColor' stroke-width='2'/><path d='M12 16v-4M12 8h.01' stroke='currentColor' stroke-width='2' stroke-linecap='round'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>Personas & Tasks</b><ul class='mt-1 ml-2 list-disc list-inside'><li><b>Software Engineering:</b> Build and maintain UI and backend</li><li><b>User Acceptance Testing:</b> Validate usability and correctness</li><li><b>Project Management:</b> Define requirements, track progress</li><li><b>Data Science:</b> Develop and validate ML models</li><li><b>Business SME:</b> Provide domain expertise</li></ul></div>
                    </span>
                </button>
                <button tabindex="0" aria-label="AI Impacts" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-green-400' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><rect x='4' y='4' width='16' height='16' rx='4' stroke='currentColor' stroke-width='2'/><path d='M8 12h8M12 8v8' stroke='currentColor' stroke-width='2' stroke-linecap='round'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>AI Impacts</b><ul class='mt-1 ml-2 list-disc list-inside'><li><span class='font-semibold text-green-400'>Positive:</span> Predictive maintenance reduces downtime <span class='text-blue-300'>(Personas: Operator, Data Science)</span></li><li><span class='font-semibold text-red-400'>Negative:</span> Over-reliance on AI may mask real issues <span class='text-blue-300'>(Personas: Operator, Project Management)</span></li></ul></div>
                    </span>
                </button>
                <button tabindex="0" aria-label="Design Intent" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-yellow-300' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><path d='M12 6v6l4 2' stroke='currentColor' stroke-width='2' stroke-linecap='round'/><circle cx='12' cy='12' r='10' stroke='currentColor' stroke-width='2'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>Design Intent</b><ul class='mt-1 ml-2 list-disc list-inside'><li><b>Functionality:</b> Show event log for all machines</li><li><b>Data:</b> Event history records</li><li><b>Behavior:</b> Sortable, filterable, accessible</li></ul></div>
                    </span>
                </button>
            </h2>
            <div class="overflow-x-auto">
                <table class="min-w-full bg-gray-900 rounded-lg shadow text-sm border border-blue-900">
                    <thead>
                        <tr class="bg-blue-950">
                            <th class="px-4 py-2 text-left text-blue-200">Time</th>
                            <th class="px-4 py-2 text-left text-blue-200">Machine</th>
                            <th class="px-4 py-2 text-left text-blue-200">Event</th>
                            <th class="px-4 py-2 text-left text-blue-200">Operator Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="px-4 py-2 text-gray-300">10:12</td>
                            <td class="px-4 py-2 text-gray-300">Filler #1</td>
                            <td class="px-4 py-2 text-gray-400">Stopped (Jam)</td>
                            <td class="px-4 py-2 text-gray-400">Cleared Jam</td>
                        </tr>
                        <!-- More rows as needed -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Alerts Section -->
        <section id="alerts" class="mb-8">
            <h2 class="text-xl font-semibold mb-2 text-blue-200">Active Alerts
                <button tabindex="0" aria-label="Personas & Tasks" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-blue-300' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><circle cx='12' cy='12' r='10' stroke='currentColor' stroke-width='2'/><path d='M12 16v-4M12 8h.01' stroke='currentColor' stroke-width='2' stroke-linecap='round'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>Personas & Tasks</b><ul class='mt-1 ml-2 list-disc list-inside'><li><b>Software Engineering:</b> Build and maintain UI and backend</li><li><b>User Acceptance Testing:</b> Validate usability and correctness</li><li><b>Project Management:</b> Define requirements, track progress</li><li><b>Data Science:</b> Develop and validate ML models</li><li><b>Business SME:</b> Provide domain expertise</li></ul></div>
                    </span>
                </button>
                <button tabindex="0" aria-label="AI Impacts" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-green-400' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><rect x='4' y='4' width='16' height='16' rx='4' stroke='currentColor' stroke-width='2'/><path d='M8 12h8M12 8v8' stroke='currentColor' stroke-width='2' stroke-linecap='round'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>AI Impacts</b><ul class='mt-1 ml-2 list-disc list-inside'><li><span class='font-semibold text-green-400'>Positive:</span> Predictive maintenance reduces downtime <span class='text-blue-300'>(Personas: Operator, Data Science)</span></li><li><span class='font-semibold text-red-400'>Negative:</span> Over-reliance on AI may mask real issues <span class='text-blue-300'>(Personas: Operator, Project Management)</span></li></ul></div>
                    </span>
                </button>
                <button tabindex="0" aria-label="Design Intent" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-yellow-300' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><path d='M12 6v6l4 2' stroke='currentColor' stroke-width='2' stroke-linecap='round'/><circle cx='12' cy='12' r='10' stroke='currentColor' stroke-width='2'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>Design Intent</b><ul class='mt-1 ml-2 list-disc list-inside'><li><b>Functionality:</b> Display and acknowledge active alerts</li><li><b>Data:</b> Live alert feed</li><li><b>Behavior:</b> Operator can acknowledge, see details</li></ul></div>
                    </span>
                </button>
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-red-900 border-l-4 border-red-500 p-4 rounded flex items-center justify-between shadow">
                    <div>
                        <div class="font-medium text-red-300">Capper #2: Emergency Stop</div>
                        <div class="text-xs text-red-200">11:03 AM</div>
                    </div>
                    <button class="bg-red-700 text-white px-3 py-1 rounded hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-red-400 transition">Acknowledge</button>
                </div>
                <!-- More alerts as needed -->
            </div>
        </section>

        <!-- ML Models Section -->
        <section id="ml" class="mb-8">
            <h2 class="text-xl font-semibold mb-2 text-blue-200">ML Models Management
                <button tabindex="0" aria-label="Personas & Tasks" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-blue-300' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><circle cx='12' cy='12' r='10' stroke='currentColor' stroke-width='2'/><path d='M12 16v-4M12 8h.01' stroke='currentColor' stroke-width='2' stroke-linecap='round'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>Personas & Tasks</b><ul class='mt-1 ml-2 list-disc list-inside'><li><b>Software Engineering:</b> Build and maintain UI and backend</li><li><b>User Acceptance Testing:</b> Validate usability and correctness</li><li><b>Project Management:</b> Define requirements, track progress</li><li><b>Data Science:</b> Develop and validate ML models</li><li><b>Business SME:</b> Provide domain expertise</li></ul></div>
                    </span>
                </button>
                <button tabindex="0" aria-label="AI Impacts" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-green-400' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><rect x='4' y='4' width='16' height='16' rx='4' stroke='currentColor' stroke-width='2'/><path d='M8 12h8M12 8v8' stroke='currentColor' stroke-width='2' stroke-linecap='round'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>AI Impacts</b><ul class='mt-1 ml-2 list-disc list-inside'><li><span class='font-semibold text-green-400'>Positive:</span> Predictive maintenance reduces downtime <span class='text-blue-300'>(Personas: Operator, Data Science)</span></li><li><span class='font-semibold text-red-400'>Negative:</span> Over-reliance on AI may mask real issues <span class='text-blue-300'>(Personas: Operator, Project Management)</span></li></ul></div>
                    </span>
                </button>
                <button tabindex="0" aria-label="Design Intent" class="ml-1 inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-800 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 relative group">
                    <svg class='w-4 h-4 text-yellow-300' fill='none' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24'><path d='M12 6v6l4 2' stroke='currentColor' stroke-width='2' stroke-linecap='round'/><circle cx='12' cy='12' r='10' stroke='currentColor' stroke-width='2'/></svg>
                    <span class="absolute z-20 left-8 top-1/2 -translate-y-1/2 hidden group-hover:block group-focus:block bg-gray-900 text-xs text-gray-100 rounded shadow-lg px-3 py-2 w-64 text-left">
                        <div><b>Design Intent</b><ul class='mt-1 ml-2 list-disc list-inside'><li><b>Functionality:</b> Manage ML models for machines</li><li><b>Data:</b> Model metadata, deployment status</li><li><b>Behavior:</b> Deploy, remove, view details</li></ul></div>
                    </span>
                </button>
            </h2>
            <div class="bg-gray-900 rounded-lg shadow p-4 flex flex-col gap-4 border border-blue-900">
                <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
                    <label for="ml-model-select" class="sr-only">Select ML Model</label>
                    <select id="ml-model-select" class="border border-blue-800 bg-gray-950 text-gray-100 rounded px-2 py-1 text-sm" aria-label="Select ML Model">
                        <option>Filler #1 - Predictive Maintenance</option>
                        <option>Capper #2 - Quality Control</option>
                    </select>
                    <button class="bg-blue-700 text-white px-3 py-1 rounded hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-400 transition">View Details</button>
                    <button class="bg-green-700 text-white px-3 py-1 rounded hover:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-400 transition">Deploy</button>
                    <button class="bg-gray-700 text-gray-200 px-3 py-1 rounded hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-400 transition">Remove</button>
                </div>
                <!-- Placeholder for model details -->
                <div class="h-24 bg-blue-950 rounded flex items-center justify-center text-gray-500 border border-blue-900">[Model Details Placeholder]</div>
            </div>
        </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script>
    // --- SENSOR VALUE FUNCTION ---
    function getSensorValue(machineId) {
        const t = telemetryData[machineId];
        if (!t) return '?';
        if (timelineMode === 'simulation') {
            // Simulate value based on timelineIndex
            const arr = [...t.past, t.now, ...t.forecast];
            return arr[timelineIndex];
        } else {
            // Realtime: always show now
            return t.now;
        }
    }

    // --- DATA ---
    const machines = [
        { id: 'filler', name: 'Filler', x: 120, color: '#2563eb', state: 'running', sensors: [{ id: 'filler-temp', name: 'Temp', value: 22, unit: '°C', color: '#38bdf8' }] },
        { id: 'capper', name: 'Capper', x: 255, color: '#0ea5e9', state: 'idle', sensors: [{ id: 'capper-torque', name: 'Torque', value: 12, unit: 'Nm', color: '#38bdf8' }] },
        { id: 'labeler', name: 'Labeler', x: 410, color: '#10b981', state: 'fault', sensors: [{ id: 'labeler-speed', name: 'Speed', value: 120, unit: 'bpm', color: '#38bdf8' }] },
        { id: 'packer', name: 'Packer', x: 570, color: '#f59e42', state: 'running', sensors: [{ id: 'packer-load', name: 'Load', value: 80, unit: '%', color: '#38bdf8' }] },
        { id: 'palletizer', name: 'Palletizer', x: 750, color: '#ef4444', state: 'running', sensors: [{ id: 'palletizer-pos', name: 'Pos', value: 5, unit: '', color: '#38bdf8' }] },
    ];
    // Simulated telemetry data for each machine (past, now, forecast)
    const telemetryData = {
        filler:   { past: [20,21,22,23,22,21,22], now: 22, forecast: [22,23,24,23,22] },
        capper:   { past: [10,11,12,13,12,11,12], now: 12, forecast: [12,13,14,13,12] },
        labeler:  { past: [100,110,120,130,120,110,120], now: 120, forecast: [120,130,140,130,120] },
        packer:   { past: [70,75,80,85,80,75,80], now: 80, forecast: [80,85,90,85,80] },
        palletizer: { past: [3,4,5,6,5,4,5], now: 5, forecast: [5,6,7,6,5] },
    };
    // Simulated state timeline for simulation mode
    const simulationTimeline = [
        { t: 0, states: ['running','idle','fault','running','running'] },
        { t: 1, states: ['running','running','fault','running','running'] },
        { t: 2, states: ['running','running','running','running','running'] },
        { t: 3, states: ['idle','running','running','fault','running'] },
        { t: 4, states: ['idle','idle','running','fault','fault'] },
        { t: 5, states: ['running','idle','fault','running','running'] },
    ];
    let selectedMachine = 'filler';
    let timelineMode = 'realtime';
    let timelineIndex = 3; // 0 = far past, 3 = now, 6 = far forecast

    // --- SCHEMATIC RENDERING ---
    function renderSchematic() {
        const svg = document.getElementById('line-schematic');
        svg.innerHTML = '';
        // Conveyor with shadow and rounded ends
        svg.innerHTML += `<ellipse cx="90" cy="112" rx="18" ry="18" fill="#1e293b" opacity="0.5"/>`;
        svg.innerHTML += `<ellipse cx="810" cy="112" rx="18" ry="18" fill="#1e293b" opacity="0.5"/>`;
        svg.innerHTML += `<rect x="90" y="100" width="720" height="24" rx="12" fill="url(#beltGradient)" filter="url(#beltShadow)" />`;
        // Arrows (curved)
        [120,255,410,570].forEach((x,i) => {
            svg.innerHTML += `<path d="M${x+35},112 Q${x+65},100 ${x+95},112" stroke="#64748b" stroke-width="3" fill="none" marker-end="url(#arrowhead)" />`;
        });
        svg.innerHTML += `<defs><marker id="arrowhead" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto" markerUnits="strokeWidth"><polygon points="0 0, 8 4, 0 8" fill="#64748b" /></marker></defs>`;
        // Machines (rounded, with icon, shadow, and subtle gradient)
        machines.forEach((m,i) => {
            let state = m.state;
            if (timelineMode === 'simulation') {
                state = simulationTimeline[timelineIndex]?.states[i] || m.state;
            }
            let stateFill = state==='running'? '#22c55e' : state==='idle'? '#facc15' : '#ef4444';
            let gradId = `machineGrad${i}`;
            svg.innerHTML += `
                <defs>
                    <radialGradient id="${gradId}" cx="50%" cy="40%" r="70%">
                        <stop offset="0%" stop-color="#fff" stop-opacity="0.18"/>
                        <stop offset="100%" stop-color="${m.color}" stop-opacity="1"/>
                    </radialGradient>
                    <filter id="machineShadow${i}" x="-10" y="-10" width="200%" height="200%">
                        <feDropShadow dx="0" dy="6" stdDeviation="6" flood-color="#000" flood-opacity="0.18"/>
                    </filter>
                </defs>
                <g class="machine" data-id="${m.id}" style="cursor:pointer">
                    <rect x="${m.x-38}" y="62" width="76" height="46" rx="23" fill="url(\#${gradId})" stroke="${stateFill}" stroke-width="4" filter="url(\#machineShadow${i})"/>
                    <text x="${m.x}" y="92" text-anchor="middle" fill="#fff" font-size="15" font-weight="bold">${m.name}</text>
                    <g>
                        <circle cx="${m.x+28}" cy="74" r="10" fill="#22292f" stroke="#fff" stroke-width="2"/>
                        <text x="${m.x+28}" y="78" text-anchor="middle" fill="#fff" font-size="12" font-weight="bold">${m.name[0]}</text>
                    </g>
                    <title>${m.name} (${state.toUpperCase()})</title>
                </g>
            `;
        });
        // Sensors (separate loop to ensure all are rendered)
        machines.forEach((m) => {
            const sensorVal = getSensorValue(m.id);
            svg.innerHTML += `<g class="sensor-group" data-id="${m.id}">
                <ellipse cx="${m.x}" cy="112" rx="10" ry="7" fill="#38bdf8" stroke="#fff" stroke-width="2"/>
                <title>${m.sensors[0].name}: ${sensorVal}${m.sensors[0].unit}</title>
                <text x="${m.x}" y="135" text-anchor="middle" fill="#38bdf8" font-size="13" font-weight="bold" style="display:none;pointer-events:none;" class="sensor-value-label">${sensorVal}${m.sensors[0].unit}</text>
            </g>`;
        });
        // Bottles (smaller, more, and with a subtle shadow)
        for(let bx=120; bx<800; bx+=36) {
            svg.innerHTML += `<g><rect x="${bx}" y="116" width="7" height="18" rx="2" fill="#38bdf8" stroke="#2563eb" stroke-width="1" filter="url(#bottleShadow)"/><circle cx="${bx+3.5}" cy="116" r="3.5" fill="#fff" stroke="#2563eb" stroke-width="1"/></g>`;
        }
        svg.innerHTML += `<defs><filter id="bottleShadow" x="-2" y="-2" width="200%" height="200%"><feDropShadow dx="0" dy="2" stdDeviation="2" flood-color="#000" flood-opacity="0.10"/></filter></defs>`;
        // Add sensor hover interactivity
        setTimeout(() => {
            document.querySelectorAll('#line-schematic .sensor-group').forEach(g => {
                g.addEventListener('mouseenter', function() {
                    const label = this.querySelector('.sensor-value-label');
                    if (label) label.style.display = 'block';
                });
                g.addEventListener('mouseleave', function() {
                    const label = this.querySelector('.sensor-value-label');
                    if (label) label.style.display = 'none';
                });
            });
            renderMachineInfoCards(); // Render info cards after schematic
        }, 10);
    }

    // --- INFO CARDS RENDERING ---
    function renderMachineInfoCards() {
        const container = document.getElementById('machine-info-cards');
        if (!container) return;
        container.innerHTML = '';
        machines.forEach((m, i) => {
            let state = m.state;
            if (timelineMode === 'simulation') {
                state = simulationTimeline[timelineIndex]?.states[i] || m.state;
            }
            let stateColor = state === 'running' ? 'bg-green-500' : state === 'idle' ? 'bg-yellow-400' : 'bg-red-500';
            let stateLabel = state.charAt(0).toUpperCase() + state.slice(1);
            const sensor = m.sensors[0];
            const sensorVal = getSensorValue(m.id);
            // Position: map SVG x/y to percent for responsive overlay
            const left = `calc(${(m.x / 900) * 100}% - 70px)`;
            const top = '30px';
            // Responsible AI: clarity, transparency, no PII, explainability
            const explain = `Shows latest ${sensor.name} as measured by the sensor. Value updates with timeline.`;
            // Card HTML
            const card = document.createElement('div');
            card.className = `pointer-events-auto absolute`;
            card.style.left = left;
            card.style.top = top;
            card.setAttribute('role', 'region');
            card.setAttribute('aria-label', `${m.name} info card`);
            card.innerHTML = `
                <div class="w-44 bg-gray-900/95 border border-blue-900 rounded-xl shadow-lg p-3 flex flex-col gap-1 text-xs text-gray-100" tabindex="0">
                    <div class="flex items-center gap-2 mb-1">
                        <span class="inline-block w-2.5 h-2.5 rounded-full ${stateColor}" aria-label="${stateLabel}"></span>
                        <span class="font-semibold text-sm">${m.name}</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <span class="text-blue-300 font-medium">${sensor.name}:</span>
                        <span class="text-lg font-mono text-blue-400">${sensorVal}</span>
                        <span class="text-blue-200">${sensor.unit}</span>
                    </div>
                    <div class="text-gray-400">Status: <span class="font-medium">${stateLabel}</span></div>
                    <div class="text-gray-500" aria-label="explanation">${explain}</div>
                </div>
            `;
            container.appendChild(card);
        });
    }

    // --- TELEMETRY GRAPH ---
    let chart;
    function renderTelemetryGraph() {
        const ctx = document.getElementById('telemetry-canvas').getContext('2d');
        const t = telemetryData[selectedMachine];
        if (!t) return;
        const labels = ['-3','-2','-1','Now','+1','+2','+3'];
        const data = [...t.past, t.now, ...t.forecast];
        if (chart) {
            // Instead of destroy, update data for less "bouncy" effect
            chart.data.labels = labels;
            chart.data.datasets[0].data = data;
            chart.update();
        } else {
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels,
                    datasets: [{
                        label: machines.find(m=>m.id===selectedMachine).sensors[0].name,
                        data,
                        borderColor: '#38bdf8',
                        backgroundColor: 'rgba(56,189,248,0.2)',
                        pointBackgroundColor: '#38bdf8',
                        pointBorderColor: '#fff',
                        tension: 0.4,
                        fill: true,
                    }]
                },
                options: {
                    animation: { duration: 300 },
                    plugins: { legend: { labels: { color: '#fff' } } },
                    scales: {
                        x: { ticks: { color: '#fff' }, grid: { color: '#334155' } },
                        y: { ticks: { color: '#fff' }, grid: { color: '#334155' } }
                    },
                    responsive: true,
                    maintainAspectRatio: false,
                }
            });
        }
        document.getElementById('telemetry-machine-label').textContent = machines.find(m=>m.id===selectedMachine).name;
    }

    // --- INTERACTION ---
    document.getElementById('line-schematic').addEventListener('click', function(e) {
        const pt = this.createSVGPoint();
        pt.x = e.offsetX; pt.y = e.offsetY;
        const svgPt = pt.matrixTransform(this.getScreenCTM().inverse());
        // Find closest machine
        let minDist = 9999, minId = 'filler';
        machines.forEach(m => {
            const dx = svgPt.x - m.x, dy = svgPt.y - 85;
            const d = Math.sqrt(dx*dx+dy*dy);
            if (d < minDist && d < 40) { minDist = d; minId = m.id; }
        });
        selectedMachine = minId;
        renderTelemetryGraph();
    });
    document.querySelectorAll('input[name="timeline-mode"]').forEach(radio => {
        radio.addEventListener('change', e => {
            timelineMode = e.target.value;
            renderSchematic();
            renderTelemetryGraph();
            updateTimelineLabels();
        });
    });
    document.getElementById('telemetry-range').addEventListener('input', function(e) {
        // Map 0-100 to timelineIndex 0-6
        timelineIndex = Math.round((+e.target.value) / 100 * 6);
        renderSchematic();
        renderTelemetryGraph();
    });
    function updateTimelineLabels() {
        if (timelineMode === 'realtime') {
            document.getElementById('timeline-left-label').textContent = 'Past';
            document.getElementById('timeline-center-label').textContent = 'Now';
            document.getElementById('timeline-right-label').textContent = 'Forecast';
        } else {
            document.getElementById('timeline-left-label').textContent = 'Sim Past';
            document.getElementById('timeline-center-label').textContent = 'Sim Now';
            document.getElementById('timeline-right-label').textContent = 'Sim Forecast';
        }
    }
    document.getElementById('replay-btn').addEventListener('click', function() {
        // Simulate replay: animate timelineIndex from 0 to 6
        let i = 0;
        // Prevent multiple intervals
        if (window._replayInterval) clearInterval(window._replayInterval);
        window._replayInterval = setInterval(() => {
            timelineIndex = i;
            document.getElementById('telemetry-range').value = (i/6)*100;
            renderSchematic();
            renderTelemetryGraph();
            i++;
            if (i > 6) {
                clearInterval(window._replayInterval);
                window._replayInterval = null;
            }
        }, 500);
    });

    // --- Update info cards on schematic/timeline changes ---
    function updateAllInfoCards() {
        renderMachineInfoCards();
    }

    // Patch schematic/timeline/telemetry updates to also update info cards
    const _origRenderSchematic = renderSchematic;
    renderSchematic = function() {
        _origRenderSchematic();
        updateAllInfoCards();
    };
    const _origRenderTelemetryGraph = renderTelemetryGraph;
    renderTelemetryGraph = function() {
        _origRenderTelemetryGraph();
        updateAllInfoCards();
    };

    // Initial render
    renderSchematic();
    renderTelemetryGraph();
    updateTimelineLabels();
    window.addEventListener('DOMContentLoaded', updateAllInfoCards);
    </script>
</body>
</html>
